lu <- readRDS(file.path(path, "lu_clean.rds"))
lu
dep <- lu$Recreation
path <- "C:/Users/Alexander/Documents/Uni/WiSe22/Datenanalyse/Data"
lu <- readRDS(file.path(path, "lu_clean.rds"))
lu
dep <- lu$Recreation
ind <- lu$Settlement
library(car)
install.packages("car")
par_org <- par()
par(par_org)
plot(ind, dep)
lmod <- lm(dep ~ ind) # Compute linear regression model
plot(ind, dep)
lmod <- lm(dep ~ ind) # Compute linear regression model
regLine(lmod, col = "red") # Add regression line to plot (requires car package)
text(10, 6, bquote(paste("y"["i"], " = ", .(round(lmod$coefficients[1], 3)),
" + ", .(round(lmod$coefficients[2], 3)), "* x"["i"])))
par(par_org)
par(mfrow = c(2,2))
for(i in seq(4)){
plot(lmod[[i]], which = 1)
}
dep <- lu$Recreation
ind <- lu$Settlement
library(car)
par_org <- par()
par(par_org)
plot(ind, dep,
xlab = "settlement area percentage",
ylab = "recreation area percentage")
lmod <- lm(dep ~ ind) # Compute linear regression model
regLine(lmod, col = "red") # Add regression line to plot (requires car package)
text(10, 6, bquote(paste("y"["i"], " = ", .(round(lmod$coefficients[1], 3)),
" + ", .(round(lmod$coefficients[2], 3)), "* x"["i"])))
dep <- lu$Recreation
ind <- lu$Settlement
library(car)
par_org <- par()
par(par_org)
plot(ind, dep,
main = "linear regression model for assignment_05"
xlab = "settlement area percentage",
dep <- lu$Recreation
ind <- lu$Settlement
library(car)
par_org <- par()
par(par_org)
plot(ind, dep,
main = "linear regression model for assignment_05",
xlab = "settlement area percentage",
ylab = "recreation area percentage")
lmod <- lm(dep ~ ind) # Compute linear regression model
regLine(lmod, col = "red") # Add regression line to plot (requires car package)
text(10, 6, bquote(paste("y"["i"], " = ", .(round(lmod$coefficients[1], 3)),
" + ", .(round(lmod$coefficients[2], 3)), "* x"["i"])))
par(par_org)
plot(lmod, which = 1)
par(par_org)
par(mfrow(1,2))
par(par_org)
par(mfrow = c(1,2))
plot(lmod, which = 1)
plot(lmod, which = 3)
par(par_org)
par(mfrow = c(2,2))
plot(lmod, which = 1)
plot(lmod, which = 2)
plot(lmod, which = 3)
par(par_org)
par(mfrow = c(2,2))
plot(lmod, which = 1)
plot(lmod, which = 2)
plot(lmod, which = 3)
plot(lmod, which = 4)
sample(lu$Settlement, 50)
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
lapply(lmodels, summary)
sum(lmodels)
names(summary(lmodels))
names(summary(lmodels[1]))
names(summary(lmodels[[1]]))
summary(lmodels[[1]])
summary(lmodels[[1]])$fstatistic
summary(lmodels[[1]])$cov.unscaled
summary(lmodels[[1]])$aliased
summary(lmodels[[1]])$sigma
summary(lmodels[[1]])$df
summary(lmodels[[1]])$r.squared
summary(lmodels[[1]])$pvalue
summary(lmodels[[1]])$coefficients[,4]
summary(lmodels[[1]])$coefficients[,4] < 0,05
summary(lmodels[[1]])$coefficients[,4] < 0.05
summary(lmodels[[1]])$coefficients[1,4]
summary(lmodels[[1]])$coefficients[2,4]
summary(lmodels[[1]])$coefficients[2,4] < 0.05
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(lmodels[[i]])$coefficients[2,4] < 0.05
})
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
View(p_fit)
sum(p_fit)
unique(p_fit)
table(p_fit)
as.data.frame(table(dummyData))
as.data.frame(table(p_fit))
aggregate(data.frame(count = p_fit), list(value = p_fit), length)
p_fit
colnames(p_fit)
count(which(p_fit == TRUE))
which(p_fit == TRUE)
sum(which(p_fit == TRUE))
count(p_fit)
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
which(p_fit == TRUE)
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
set.seed(707)
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
set.seed(707)
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
length(which(p_fit == TRUE))
par(mfrow = c(10,10))
for(i in seq(100)){
plot(lmodels[[i]], which = 2)
}
p_fit[[20]]
for (i in seq(100)){
if (p_fit[[i]] == TRUE){
plot(lmodels[[i]], which = 2)
}
par(mfrow = c(3,2))
for (i in seq(100)){
if (p_fit[[i]] == TRUE){
plot(lmodels[[i]], which = 2)
}
par(mfrow = c(2,3))
for (i in seq(100)){
if (p_fit[[i]] == TRUE){
plot(lmodels[[i]], which = 2)
}
p_fit == TRUE
which(p_fit == TRUE)
plot(lmodels[[3]], which = 2)
plot(lmodels[[20]], which = 2)
plot(lmodels[[80], which = 2)
plot(lmodels[[80]], which = 2)
par(mfrow = c(2,3))
for (i in seq(100)){
if (p_fit[[i]] == TRUE){
plot(lmodels[[i]],
which = 2,
main = paste0("Normal Q-Q, lm_", i)
)
}
par(mfrow = c(2,3))
for (i in seq(100)){
if (p_fit[[i]] == TRUE){
plot(lmodels[[i]],
which = 2,
main = paste0("Normal Q-Q, lm_", i)
)
}
par(mfrow = c(2,3))
for (i in seq(100)){
if (p_fit[[i]] == TRUE){
plot(lmodels[[i]], which = 2)
}
View(lu)
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print("p < 0.05: ", which(p_fit == TRUE))
print("Total:", length(which(p_fit == TRUE)), " models")
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print("p < 0.05: ", which(p_fit == TRUE))
paste0("Total: ", length(which(p_fit == TRUE)), " models")
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
paste0("p < 0.05: ", which(p_fit == TRUE))
paste0("Total: ", length(which(p_fit == TRUE)), " models")
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("p < 0.05: ", which(p_fit == TRUE)))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", i))
print(paste0("p < 0.05: ", c(which(p_fit == TRUE))))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", i))
print(paste0("p < 0.05: ", as.vector(which(p_fit == TRUE))))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(paste0("p < 0.05: ", as.list(which(p_fit == TRUE))))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"), "\n")
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"), \n)
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"), "\n")
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models", "\n"))
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
print("")
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
print()
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
print("#-------------#")
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
print("#--------------------#")
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
print("--------------------")
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
print("#--------------------#", quote = FALSE)
}
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
print("--------------------", quote = FALSE)
}
set.seed(707)
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
for (j in seq(5)){
lmodels <-  lapply(seq(100), function(i){
lm(sample(dep, 50) ~ sample(ind, 50))
})
p_fit <- lapply(lmodels, function(i){
summary(i)$coefficients[2,4] < 0.05
})
print(paste0("Run Nr.", j))
print(which(p_fit == TRUE))
print(paste0("Total: ", length(which(p_fit == TRUE)), " models"))
print("--------------------", quote = FALSE)
}
par(par_org)
par(mfrow = c(2,2))
for (i in seq(100)){
if (p_fit[[i]] == TRUE){
plot(lmodels[[i]], which = 2)
}
